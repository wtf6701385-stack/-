local CatLib = {}
CatLib.__index = CatLib

function CatLib.Init()
    local self = setmetatable({}, CatLib)
    
    local main = Instance.new("ScreenGui")
    main.Name = "NekoLibrary_V12"
    main.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    main.ResetOnSpawn = false
    self.MainGui = main

    -- === ä¸»é¢æ¿ (æ¡ç”¨ V12 çš„ 210x130 æ¯”ä¾‹èˆ‡æ·±è‰²èƒŒæ™¯) ===
    local Frame = Instance.new("Frame", main)
    Frame.Size = UDim2.new(0, 210, 0, 150) -- ç¨å¾®åŠ é«˜ä¸€é»é»ä»¥å®¹ç´åˆ†é 
    Frame.Position = UDim2.new(0.5, -105, 0.4, 0)
    Frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    Frame.BackgroundTransparency = 0.25 
    Frame.Active = true
    Frame.Draggable = true
    self.MainFrame = Frame

    Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 20)

    local Stroke = Instance.new("UIStroke", Frame)
    Stroke.Thickness = 3
    Stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    self.MainStroke = Stroke

    -- === é ‚éƒ¨åˆ— (ğŸ± NYAN PROTOCOL ğŸ¾) ===
    local TopBar = Instance.new("Frame", Frame)
    TopBar.Size = UDim2.new(1, 0, 0, 35)
    TopBar.BackgroundTransparency = 1
    
    local Title = Instance.new("TextLabel", TopBar)
    Title.Size = UDim2.new(1, 0, 1, 0)
    Title.Text = "NYAN PROTOCOL"
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 11
    Title.BackgroundTransparency = 1
    self.MainTitle = Title

    -- === åˆ†é åˆ‡æ›å®¹å™¨ (é ‚éƒ¨å°åˆ—) ===
    local TabContainer = Instance.new("ScrollingFrame", Frame)
    TabContainer.Size = UDim2.new(1, -20, 0, 25)
    TabContainer.Position = UDim2.new(0, 10, 0, 35)
    TabContainer.BackgroundTransparency = 1
    TabContainer.ScrollBarThickness = 0
    TabContainer.CanvasSize = UDim2.new(2, 0, 0, 0)
    local TabList = Instance.new("UIListLayout", TabContainer)
    TabList.FillDirection = Enum.FillDirection.Horizontal
    TabList.Padding = UDim.new(0, 5)
    self.TabContainer = TabContainer

    -- === å…§å®¹å®¹å™¨ (æ”¾ç½®åŠŸèƒ½æŒ‰éˆ•) ===
    local PageContainer = Instance.new("Frame", Frame)
    PageContainer.Size = UDim2.new(1, -20, 1, -70)
    PageContainer.Position = UDim2.new(0, 10, 0, 65)
    PageContainer.BackgroundTransparency = 1
    self.PageContainer = PageContainer

    -- RGB å‹•æ…‹æ•ˆæœ
    task.spawn(function()
        while main.Parent do
            local rgb = Color3.fromHSV(tick() % 5 / 5, 0.7, 1)
            Stroke.Color = rgb
            Title.TextColor3 = rgb
            task.wait()
        end
    end)

    return self
end

-- === å»ºç«‹åˆ†é  (æŒ‰éˆ•æ¨£å¼å¥—ç”¨ V12) ===
function CatLib:CreateTab(name, isFirst)
    local tabBtn = Instance.new("TextButton", self.TabContainer)
    tabBtn.Size = UDim2.new(0, 60, 1, 0)
    tabBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    tabBtn.BackgroundTransparency = 0.4
    tabBtn.Text = name
    tabBtn.TextColor3 = Color3.new(1,1,1)
    tabBtn.Font = Enum.Font.GothamBold
    tabBtn.TextSize = 10
    Instance.new("UICorner", tabBtn).CornerRadius = UDim.new(0, 8)

    local page = Instance.new("ScrollingFrame", self.PageContainer)
    page.Size = UDim2.new(1, 0, 1, 0)
    page.BackgroundTransparency = 1
    page.Visible = isFirst or false
    page.ScrollBarThickness = 0
    page.CanvasSize = UDim2.new(0, 0, 2, 0)
    Instance.new("UIListLayout", page).Padding = UDim.new(0, 5)

    tabBtn.MouseButton1Click:Connect(function()
        for _, p in pairs(self.PageContainer:GetChildren()) do 
            if p:IsA("ScrollingFrame") then p.Visible = false end 
        end
        page.Visible = true
    end)

    return page
end

-- === å»ºç«‹è³‡è¨Šæ¨™ç±¤ ===
function CatLib:CreateInfo(parent, icon, text)
    local info = Instance.new("TextLabel", parent)
    info.Size = UDim2.new(1, 0, 0, 25)
    info.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    info.BackgroundTransparency = 0.5
    info.Text = icon .. " " .. text
    info.TextColor3 = Color3.new(0.8, 0.8, 0.8)
    info.Font = Enum.Font.Gotham
    info.TextSize = 10
    Instance.new("UICorner", info).CornerRadius = UDim.new(0, 8)
end

-- === å»ºç«‹æŒ‰éˆ• (å®Œå…¨æ¡ç”¨ V12 çš„ applyNekoStyle æ¨£å¼) ===
function CatLib:CreateButton(parent, text, callback)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(1, 0, 0, 32)
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    btn.BackgroundTransparency = 0.3
    btn.Text = text
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 12
    
    -- V12 ç‰¹è‰²åœ“è§’èˆ‡é‚Šæ¡†
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 12)
    local s = Instance.new("UIStroke", btn)
    s.Thickness = 1.2
    s.Color = Color3.new(1, 1, 1)
    s.Transparency = 0.8

    btn.MouseButton1Click:Connect(function()
        callback(btn)
    end)

    return btn
end

return CatLib
