-- [[ ðŸ¾ è²“è²“æ ¸å¿ƒåŠŸèƒ½ (NEKOOOOO) - 2026 æˆ°é¬¥é‚è¼¯æ¨¡çµ„ ðŸ¾ ]] --
local player = game:GetService("Players").LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

local Character = player.Character or player.CharacterAdded:Wait()
player.CharacterAdded:Connect(function(newChar) Character = newChar end)

-- âœ¨ [è¦–é‡Žèˆ‡é¡é ­ä¿®æ­£]
task.spawn(function()
    while _G.NekoRunning do
        pcall(function()
            if Camera and _G.Settings then
                Camera.FieldOfView = _G.Settings.FOV
                player.CameraMaxZoomDistance = _G.Settings.ZoomDist
            end
        end)
        task.wait(0.5)
    end
end)

-- âœ¨ [çµ²æ»‘åŠ é€Ÿ]
RunService.Heartbeat:Connect(function()
    if not _G.NekoRunning or not _G.Settings.SpeedEnabled then return end
    if Character then
        local hum = Character:FindFirstChildOfClass("Humanoid")
        if hum and hum.MoveDirection.Magnitude > 0 then
            Character:TranslateBy(hum.MoveDirection * (_G.Settings.CatSpeedValue / 10))
        end
    end
end)

-- âœ¨ [æˆ°é¬¥å¾ªç’° Aï¼šç¥žåˆ€]
task.spawn(function()
    while _G.NekoRunning do
        if _G.NekoAttack and _G.Settings.Mode ~= "None" then
            pcall(function()
                local root = Character:FindFirstChild("HumanoidRootPart")
                local Net = ReplicatedStorage:FindFirstChild("Modules") and ReplicatedStorage.Modules:FindFirstChild("Net")
                if not (root and Net) then return end

                local NekoTargets, NekoPart = {}, nil
                local function Scan(folder, isPlayers)
                    for _, obj in ipairs(folder:GetChildren()) do
                        local enemyChar = isPlayers and obj.Character or obj
                        if enemyChar and enemyChar ~= Character then
                            local eH = enemyChar:FindFirstChildOfClass("Humanoid")
                            local eR = enemyChar:FindFirstChild("HumanoidRootPart")
                            if eH and eH.Health > 0 and eR and (eR.Position - root.Position).Magnitude < _G.Settings.Distance then
                                if _G.Settings.PullEnemies and not isPlayers then eR.CFrame = root.CFrame * CFrame.new(0, 0, -3) end
                                NekoPart = eR; table.insert(NekoTargets, {enemyChar, eR})
                            end
                        end
                    end
                end
                Scan(workspace:FindFirstChild("Enemies") or workspace, false)
                if _G.Settings.Mode == "All" then Scan(game:GetService("Players"), true) end
                if NekoPart then 
                    Net["RE/RegisterAttack"]:FireServer(_G.Settings.ClickDelay)
                    Net["RE/RegisterHit"]:FireServer(NekoPart, NekoTargets) 
                end
            end)
        end
        task.wait(_G.Settings.ClickDelay)
    end
end)

-- âœ¨ [æˆ°é¬¥å¾ªç’° Bï¼šæžœå¯¦]
task.spawn(function()
    while _G.NekoRunning do
        if _G.FruitAttack then
            pcall(function()
                local root = Character:FindFirstChild("HumanoidRootPart")
                local tool = Character:FindFirstChildOfClass("Tool")
                if root and tool then
                    local target, dist = nil, _G.Settings.Distance
                    local enemies = workspace:FindFirstChild("Enemies") or workspace
                    for _, v in ipairs(enemies:GetChildren()) do
                        local eH, eR = v:FindFirstChildOfClass("Humanoid"), v:FindFirstChild("HumanoidRootPart")
                        if eH and eH.Health > 0 and eR and v ~= Character then
                            local m = (eR.Position - root.Position).Magnitude
                            if m < dist then dist = m; target = eR end
                        end
                    end
                    if target then
                        root.CFrame = CFrame.new((target.CFrame * CFrame.new(0, _G.Settings.FruitHeight, -3)).p, target.Position)
                        local Net = ReplicatedStorage.Modules.Net
                        Net["RE/RegisterAttack"]:FireServer()
                        Net["RE/RegisterHit"]:FireServer(target, {{target.Parent, target}})
                        tool:Activate()
                    end
                end
            end)
        end
        task.wait(_G.Settings.FruitDelay)
    end
end)

-- âœ¨ [è‡ªå‹• V4]
task.spawn(function()
    while _G.NekoRunning do
        if _G.AutoV4 and Character then
            pcall(function()
                local awake = Character:FindFirstChild("Awakening") or player.Backpack:FindFirstChild("Awakening")
                if awake then awake.RemoteFunction:InvokeServer(true) end
            end)
        end
        task.wait(1)
    end
end)
