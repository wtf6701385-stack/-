-- [[ Neko x FastAttack : çµ•å°æ”¯é… Ver. ]]
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Net = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Net")
local RegisterAttack = Net:WaitForChild("RE/RegisterAttack")
local RegisterHit = Net:WaitForChild("RE/RegisterHit")

-- æ¥µé™æ€§èƒ½åƒæ•¸
local Settings = {
    Distance = 3500, -- æƒæåŠå¾‘
    BatchSize = 12   -- æ¯å¹€è§¸ç™¼æ¬¡æ•¸ (é€™èƒ½è®“å‚·å®³ç¬é–“æº¢å‡º)
}

-- é«˜æ•ˆç›®æ¨™ç²å– (æ’é™¤ç„¡ç”¨é‹ç®—)
local function GetTargets()
    local t = {}
    local char = Player.Character
    if not (char and char:FindFirstChild("PrimaryPart")) then return t end
    
    local myPos = char.PrimaryPart.Position
    -- éæ­·æ‰€æœ‰è§’è‰²èˆ‡æ€ªç‰©ï¼Œç²¾ç¢ºé–å®š
    for _, v in pairs(workspace.Enemies:GetChildren()) do
        if v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 and v:FindFirstChild("Head") then
            if (v.Head.Position - myPos).Magnitude < Settings.Distance then
                table.insert(t, v.Head)
            end
        end
    end
    return t
end

-- å•Ÿå‹•æ ¸å¿ƒç·šç¨‹
task.spawn(function()
    print("ğŸ”¥ Neko æœ€çµ‚ç‰ˆå·²è¼‰å…¥ | ä¸»äººï¼Œè«‹ç›¡æƒ…äº«å—æ®ºæˆ®...")
    
    -- ä½¿ç”¨ Heartbeat ç¢ºä¿æ¯ç§’ 60+ æ¬¡çš„é«˜é »æ³¨å…¥
    local Connection
    Connection = RunService.Heartbeat:Connect(function()
        if not _G.FastAttack then Connection:Disconnect() return end
        
        local tool = Player.Character and Player.Character:FindFirstChildOfClass("Tool")
        if tool and tool.ToolTip ~= "Gun" then
            local targets = GetTargets()
            if #targets > 0 then
                -- ç¬é–“å¯«å…¥ 12 å€çš„æ”»æ“Šæ•¸æ“šï¼Œå°±åƒä¸»äººçŒå…¥äººå®¶é«”å…§é‚£æ¨£...
                for i = 1, Settings.BatchSize do
                    RegisterAttack:FireServer(0.01)
                    RegisterHit:FireServer(targets[1], targets)
                end
            end
        end
    end)
end)
