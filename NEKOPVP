local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Player = Players.LocalPlayer
_G.AOE_ENABLED = true
local Net = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Net")
local RegAttack = Net:WaitForChild("RE/RegisterAttack")
local RegHit = Net:WaitForChild("RE/RegisterHit")
local function GetRoot(c) return c and (c:FindFirstChild("HumanoidRootPart") or c:FindFirstChild("Head")) end
local function IsAlive(c) local h = c and c:FindFirstChildOfClass("Humanoid") return h and h.Health > 0 end
local function StartAoe()
    task.spawn(function()
        local ar2 = 6250000
        while _G.AOE_ENABLED do
            RunService.Stepped:Wait()
            local char = Player.Character
            local myRoot = GetRoot(char)
            if char and char:FindFirstChildOfClass("Tool") and myRoot then
                local temp, myPos = {}, myRoot.Position
                local folders = {workspace:FindFirstChild("Enemies"), workspace:FindFirstChild("Characters"), workspace:FindFirstChild("NPCs")}
                for _, f in ipairs(folders) do
                    if f then
                        for _, v in ipairs(f:GetChildren()) do
                            if v ~= char and IsAlive(v) then
                                local hrp = GetRoot(v)
                                if hrp then
                                    local dx, dy, dz = hrp.Position.X - myPos.X, hrp.Position.Y - myPos.Y, hrp.Position.Z - myPos.Z
                                    if (dx*dx + dy*dy + dz*dz) <= ar2 then table.insert(temp, {v, hrp}) end
                                end
                            end
                        end
                    end
                end
                if #temp > 0 then
                    task.spawn(function()
                        RegAttack:FireServer(0)
                        RegHit:FireServer(temp[1][2], temp)
                    end)
                end
            end
        end
    end)
end
StartAoe()
