if getgenv().NEKO_RUNNING then
    warn("å–µï¼NEKO ç³»çµ±å·²ç¶“åœ¨é‹è¡Œä¸­ï¼Œè«‹å‹¿é‡è¤‡åŠ è¼‰ï¼")
    return
end

getgenv().NEKO_RUNNING = true

local Players           = game:GetService("Players")
local LocalPlayer       = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CoreGui           = game:GetService("CoreGui")

-- =====================================
-- ğŸ›¡ï¸ ç™½åå–®é©—è­‰
-- =====================================
local WHITELIST = {
    ["Kadys5373"]    = true,
    ["Zadrian664"]   = true,
    ["Zn6xx"]        = true,
    ["jay04_23"]     = true,
    ["iandsere"]     = true,
    ["czr_0416"]     = true,
    ["tw_vic2012"]   = true,
    ["12i21777"]     = true,
    ["dandanman678"] = true,
    ["psaabfmiuh"]   = true,
    ["dt106101zz"]   = true,
    ["Liu_Ruyancat"] = true,
}

if not WHITELIST[LocalPlayer.Name] then
    pcall(function()
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/F"
        ))()
    end)
    return
end

task.spawn(function()
    task.wait(5)
    pcall(function()
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/YES"
        ))()
    end)
end)

-- æ¸…ç†èˆŠ UI
for _, n in ipairs({ "NEKO", "NekoUI", "è²“è²“è…³æœ¬", "WindUI" }) do
    local g = CoreGui:FindFirstChild(n)
    if g then
        g:Destroy()
    end
end

-- =====================================
-- ğŸŒ å…¨åŸŸç‹€æ…‹ï¼ˆèˆ‡ NEKOOOOO æˆ°é¬¥é‚è¼¯é€£å‹•ï¼‰
-- =====================================
_G.NEKO_STATUS = {
    Attack = false,
    Mode   = "None",
    V4     = false,
}

_G.Settings = {
    Distance = 3000,
    Speed    = false,
}

-- =====================================
-- ğŸ“¦ è³‡æºè¼‰å…¥
-- =====================================

-- è¼‰å…¥ UI åº«
local WindUI = loadstring(game:HttpGet(
    "https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOUI"
))()

local Window = WindUI.new("NEKO BF")

-- âœ¨âœ¨âœ¨ã€æ–°å¢ä½ç½®ã€‘æ”¶åˆæŒ‰éˆ•å‘¼å« âœ¨âœ¨âœ¨
-- é€™æœƒèª¿ç”¨ UI åº«ä¸­çš„ EditOpenButton å‡½æ•¸ï¼Œç”¢ç”Ÿæµ®å‹•é–‹é—œ
Window:EditOpenButton()

-- è¼‰å…¥æˆ°é¬¥é‚è¼¯ (ç•°æ­¥åŸ·è¡Œï¼Œé¿å…å¡ä½ UI å‹•ç•«)
task.spawn(function()
    local success, err = pcall(function()
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOOOOO"
        ))()
    end)

    if not success then
        warn("å–µï¼æˆ°é¬¥é‚è¼¯åŠ è¼‰å¤±æ•—: " .. err)
    end
end)

-- =====================================
-- ğŸ“¢ UI å…§å®¹é…ç½®
-- =====================================

local TabStatus = Window:Tab("å…¬å‘Š / ç‹€æ…‹")
local SecStatus = TabStatus:Section("ç³»çµ±å³æ™‚ç›£æ§")

local BtnUser  = SecStatus:Button("ğŸ‘¤ ç©å®¶ï¼š" .. LocalPlayer.Name, function() end)
local BtnAtk   = SecStatus:Button("âš”ï¸ æ”»æ“Šï¼šOFF", function() end)
local BtnMode  = SecStatus:Button("ğŸ§  æ¨¡å¼ï¼šNone", function() end)
local BtnV4    = SecStatus:Button("ğŸŒŒ V4ï¼šOFF", function() end)
local BtnAlive = SecStatus:Button("ğŸŸ¢ ç³»çµ±ï¼šç©©å®šé‹è¡Œä¸­", function() end)

-- ç‹€æ…‹è‡ªå‹•æ›´æ–°
task.spawn(function()
    while task.wait(0.5) do
        pcall(function()
            BtnAtk.Text =
                "âš”ï¸ æ”»æ“Šï¼š" ..
                (_G.NEKO_STATUS.Attack and "ğŸŸ¢ é‹è¡Œä¸­" or "ğŸ”´ å·²é—œé–‰")

            BtnMode.Text =
                "ğŸ§  æ¨¡å¼ï¼š" ..
                (_G.NEKO_STATUS.Mode == "Mob" and "è‡ªå‹•æ‰“æ€ª"
                or _G.NEKO_STATUS.Mode == "All" and "å…¨æ®º"
                or "ä¼‘æ¯")

            BtnV4.Text =
                "ğŸŒŒ V4ï¼š" ..
                (_G.NEKO_STATUS.V4 and "ğŸŒŸ å·²é–‹å•Ÿ" or "ğŸŒ‘ é—œé–‰")
        end)
    end
end)

-- æˆ°é¬¥åˆ†é 
local TabCombat = Window:Tab("æˆ°é¬¥æ ¸å¿ƒ")
local SecCombat = TabCombat:Section("å…¨è‡ªå‹•æ›æ©Ÿ")

SecCombat:Toggle("å•Ÿå‹•è‡ªå‹•æ”»æ“Š", function(v)
    _G.NEKO_STATUS.Attack = v
end)

SecCombat:Button("è¨­å®šï¼šè‡ªå‹•åˆ·ç´š (Mob)", function()
    _G.NEKO_STATUS.Mode = "Mob"
end)

SecCombat:Button("è¨­å®šï¼šå…¨æ®ºæ¨¡å¼ (All)", function()
    _G.NEKO_STATUS.Mode = "All"
end)

SecCombat:Button("åœæ­¢æ‰€æœ‰è¡Œç‚º", function()
    _G.NEKO_STATUS.Mode   = "None"
    _G.NEKO_STATUS.Attack = false
end)

local SecV4 = TabCombat:Section("ç¨®æ—è¦ºé†’")
SecV4:Toggle("è‡ªå‹• V4 æŠ€èƒ½ç™¼å‹•", function(v)
    _G.NEKO_STATUS.V4 = v
end)

-- ç§»å‹•åˆ†é 
local TabMove = Window:Tab("ç§»å‹•å‚³é€")
local SecMove = TabMove:Section("è§’è‰²è¡Œå‹•")

SecMove:Button("å¬å–šè²“è²“é£›è¡Œå™¨", function()
    loadstring(game:HttpGet(
        "https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOFly"
    ))()
end)

local SecTP = TabMove:Section("ä¸–ç•Œå‚³é€")
local function Travel(cmd)
    pcall(function()
        ReplicatedStorage.Remotes.CommF_:InvokeServer(cmd)
    end)
end

SecTP:Button("å‰å¾€ï¼šä¸€æµ· (Main)",        function() Travel("TravelMain") end)
SecTP:Button("å‰å¾€ï¼šäºŒæµ· (Dressrosa)",   function() Travel("TravelDressrosa") end)
SecTP:Button("å‰å¾€ï¼šä¸‰æµ· (Zou)",          function() Travel("TravelZou") end)

-- å„ªåŒ–åˆ†é 
local TabEnv = Window:Tab("ç’°å¢ƒå„ªåŒ–")
local SecFPS = TabEnv:Section("ç³»çµ±åŠ é€Ÿ")

SecFPS:Toggle("FPS æ¥µè‡´å„ªåŒ–", function(v)
    if v then
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/xiaoxuan-77/-/refs/heads/main/fpsä¼˜åŒ–"
        ))()
    end)
end)

-- æ”¶å°¾
LocalPlayer.AncestryChanged:Connect(function(_, p)
    if not p then
        getgenv().NEKO_RUNNING = false
    end
end)

print("ğŸ¾ NEKO SYSTEM å•Ÿå‹•æˆåŠŸå–µï¼")
