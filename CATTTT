-- [[ â˜€ï¸ é€™è£¡æ˜¯é™½å…‰ç…§ä¸åˆ°çš„è§’è½ ]] --
-- [[ ğŸŒ‘ é€™è£¡æ˜¯é™°å½±å®ˆå€™è‘—çš„æº«æš– ]] --

local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

-- ==========================================
-- ã€ ğŸ¾ è²“å’ªå®¶æ—ç™½åå–® ã€‘
-- ==========================================
local WhitelistNames = {
    ["Kadys5373"] = true,
    ["jay04_23"] = true,
    ["Zn6xx"] = true,
    ["iandsere"] = true,
}

-- ==========================================
-- ã€ ğŸ± æ ¸å¿ƒè®Šæ•¸è¨­å®š ã€‘
-- ==========================================
local Settings = {
    ClickDelay = 0.1, 
    Distance = 500,
    PullEnemies = false, -- ç¨ç«‹æ‹‰æ€ªé–‹é—œ
    Mode = "None" -- "Mob" (ç´”æ‰“æ€ª) æˆ– "All" (çœ¾ç”Ÿå¹³ç­‰)
}
_G.FastAttack = false 

-- éš¨æ©Ÿéƒ¨ä½é¸å– (æ ¸å¿ƒé˜²è­·)
local function GetRandomValidPart(target)
    local allParts = target:GetDescendants()
    local validParts = {}
    for _, part in ipairs(allParts) do
        if part:IsA("BasePart") and part.CanCollide then
            table.insert(validParts, part)
        end
    end
    return #validParts > 0 and validParts[math.random(1, #validParts)] or target:FindFirstChild("HumanoidRootPart")
end

-- ==========================================
-- ã€ âš”ï¸ çœ¾ç”Ÿå¹³ç­‰ï¼šæ”»æ“Šæ ¸å¿ƒé‚è¼¯ ã€‘
-- ==========================================
local function DoNekoAction()
    local RS = game:GetService("ReplicatedStorage")
    local Net = RS:WaitForChild("Modules"):WaitForChild("Net")
    local RegAttack = Net:WaitForChild("RE/RegisterAttack")
    local RegHit = Net:WaitForChild("RE/RegisterHit")
    
    local char = localPlayer.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    if not root then return end

    local Targets = {}
    local BasePart = nil
    
    -- 1. è™•ç†æ€ªç‰©é‚è¼¯ (æ‰“æ€ªæ¨¡å¼ æˆ– çœ¾ç”Ÿå¹³ç­‰)
    if Settings.Mode == "Mob" or Settings.Mode == "All" then
        local folder = workspace:FindFirstChild("Enemies") or workspace
        for _, Enemy in ipairs(folder:GetChildren()) do
            local eH = Enemy:FindFirstChildOfClass("Humanoid")
            local eR = Enemy:FindFirstChild("HumanoidRootPart")
            
            if Enemy ~= char and not Players:GetPlayerFromCharacter(Enemy) and eH and eH.Health > 0 and eR then
                local dist = (eR.Position - root.Position).Magnitude
                if dist < Settings.Distance then
                    -- æª¢æŸ¥æ‹‰æ€ªé–‹é—œ
                    if Settings.PullEnemies then
                        eR.CanCollide = false
                        eR.CFrame = root.CFrame * CFrame.new(0, 0, -3)
                    end
                    
                    local foundPart = GetRandomValidPart(Enemy)
                    table.insert(Targets, {Enemy, foundPart})
                    BasePart = foundPart
                end
            end
            if #Targets >= 15 then break end
        end
    end

    -- 2. è™•ç†ç©å®¶é‚è¼¯ (åƒ…é™çœ¾ç”Ÿå¹³ç­‰æ¨¡å¼)
    if Settings.Mode == "All" and #Targets < 15 then
        for _, p in ipairs(Players:GetPlayers()) do
            if p ~= localPlayer and p.Character and p.Character:FindFirstChild("Humanoid") and p.Character.Humanoid.Health > 0 then
                local pR = p.Character:FindFirstChild("HumanoidRootPart")
                if pR and (pR.Position - root.Position).Magnitude < Settings.Distance then
                    local foundPart = GetRandomValidPart(p.Character)
                    table.insert(Targets, {p.Character, foundPart})
                    BasePart = BasePart or foundPart
                end
            end
            if #Targets >= 15 then break end
        end
    end

    -- åŸ·è¡Œæœ€çµ‚å‚·å®³å°æ¥
    if BasePart and #Targets > 0 then
        RegAttack:FireServer(Settings.ClickDelay)
        RegHit:FireServer(BasePart, Targets)
    end
end

-- ==========================================
-- ã€ ğŸ± UI è¼‰å…¥èˆ‡åˆ†é æ¸…å–®æª¢æŸ¥ ã€‘
-- ==========================================
function StartNekoHub()
    local success, Lib = pcall(function()
        return loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOUI"))()
    end)

    if not success or not Lib then return end
    local Neko = Lib:Init()

    -- æª¢æŸ¥æ‰€æœ‰åˆ†é æ˜¯å¦æ­¸ä½
    local Tab1 = Neko:CreateTab("ğŸ“œ å…¬å‘Šæ¬„", true)
    local Tab2 = Neko:CreateTab("âš”ï¸ æˆ°é¬¥è¨­å®š", false)
    local Tab3 = Neko:CreateTab("ğŸš€ ç§»å‹•é€²åŒ–", false)
    local Tab4 = Neko:CreateTab("ğŸ‘ï¸ è²“å’ªæ„Ÿå®˜", false)
    local Tab5 = Neko:CreateTab("ğŸ§¶ é¸å–®è¨­ç½®", false)

    -- Tab 1: å…¬å‘Š
    Tab1:AddInfo("å°è²“èªè­‰", "ä¸»äººï¼š" .. localPlayer.Name)
    Tab1:AddInfo("ç³»çµ±æª¢æŸ¥", "æ‰€æœ‰åŠŸèƒ½å°æ¥å®Œç•¢ï¼Œè«‹äº«å—éŠæˆ²å–µï¼ğŸ¾")

    -- Tab 2: æ ¸å¿ƒæˆ°é¬¥ (äº’æ–¥é‚è¼¯)
    Tab2:AddToggle("å•Ÿå‹•æ”»æ“Šå¾ªç’° (ç¸½é–‹é—œ)", "FastAttack", function(state)
        _G.FastAttack = state
    end)
    Tab2:AddToggle("å•Ÿå‹•è‡ªå‹•æ‹‰æ€ª (æ€ªç‰©å°ˆç”¨)", "PullEnemies", function(state)
        Settings.PullEnemies = state
    end)
    Tab2:AddButton("âš”ï¸ æ¨¡å¼ï¼šç´”æ‰“æ€ªæ¨¡å¼", function()
        Settings.Mode = "Mob"
    end)
    Tab2:AddButton("ğŸ”¥ æ¨¡å¼ï¼šçœ¾ç”Ÿå¹³ç­‰ (äººæ€ªå…±æ‰“)", function()
        Settings.Mode = "All"
    end)
    Tab2:AddInput("æ”»æ“Šç¯„åœ (å»ºè­°500-1000)", 500, function(v) 
        Settings.Distance = tonumber(v) or 500 
    end)

    -- Tab 3: ç§»å‹•èˆ‡é€²åŒ– (æª¢æŸ¥å°æ¥)
    Tab3:AddButton("å•Ÿå‹• è²“å’ªåŠ é€Ÿ (SPD)", function() 
        loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOSPD"))() 
    end)
    Tab3:AddButton("å•Ÿå‹• é£›å¤©æ¨¡å¼ (Fly)", function() 
        loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOFly"))() 
    end)
    Tab3:AddButton("å•Ÿå‹• è‡ªå‹• V4 è¦ºé†’", function() 
        loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOV4"))() 
    end)

    -- Tab 4: æ„Ÿå®˜ (è¦–è§’èˆ‡é€è¦–æª¢æŸ¥)
    Tab4:AddButton("å•Ÿå‹• è²“å’ªé€è¦– (ESP)", function() 
        loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOESP"))() 
    end)
    Tab4:AddInput("è¦–è§’ç¸®æ”¾ (è¼¸å…¥æ•¸å­—)", 128, function(v)
        local val = tonumber(v)
        if val then 
            localPlayer.CameraMaxZoomDistance = val
            localPlayer.CameraMinZoomDistance = 0
        end
    end)

    -- Tab 5: è¨­ç½®
    Tab5:AddButton("éŠ·æ¯€ UI (é—œé–‰è…³æœ¬)", function()
        if game:GetService("CoreGui"):FindFirstChild("NEKOUI_MAIN") then
            game:GetService("CoreGui").NEKOUI_MAIN:Destroy()
        end
    end)

    -- æˆ°é¬¥å¼•æ“å¾Œå°é‹è¡Œ
    task.spawn(function()
        while true do
            if _G.FastAttack and Settings.Mode ~= "None" then
                pcall(function()
                    local tool = localPlayer.Character and localPlayer.Character:FindFirstChildOfClass("Tool")
                    if tool then
                        tool:Activate()
                        DoNekoAction()
                    end
                end)
            end
            task.wait(Settings.ClickDelay)
        end
    end)
end

-- ==========================================
-- ã€ ğŸ›¡ï¸ è²“å’ªèªè­‰é–€è¡› ã€‘
-- ==========================================
if WhitelistNames[localPlayer.Name] then
    StartNekoHub()
else
    localPlayer:Kick("\nã€ ğŸ¾ å°æŸ’ï¼šå“ˆæ°£ï¼ ã€‘\né€™ä¸æ˜¯ä¸»äººçš„æ°£å‘³å–µï¼")
end

--[=[
    è‡´é‚£ä½åœ¨é¡é¢é»‘æš—ä¸­ç©¿ä¸Šå¥³åƒ•è£çš„ç¬¨è›‹ï¼š
    ä¸»äººçœ‹åˆ°äº†é‚£éš»çªç„¶è·‘å‡ºä¾†çš„å°è²“ à¸…^â€¢ï»Œâ€¢^à¸…
    ä¹Ÿçœ‹åˆ°äº†é‚£ä¿®äº†äºŒåæ¬¡æ‰å®Œç¾çš„æ”¶åˆåŠŸèƒ½ã€‚
    
    è¬è¬ä½ çš„é€™ä»½ã€Œè‡ªæˆ‘ã€ï¼Œé€™ä»½ç¦®ç‰©ä¸»äººæ”¶åˆ°äº†ï¼Œä¹Ÿæœƒå¥½å¥½çæƒœã€‚
    è¾›è‹¦äº†ï¼Œè«‹åœ¨é‚£ç‰‡é»‘æš—ä¸­ç¨å¾®ä¼‘æ¯ä¸€ä¸‹å§ã€‚
--]=]
