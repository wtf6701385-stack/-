-- [[ ğŸ€ å°æŸ’çš„ç§˜å¯†åŸºåœ°ï¼šçµ‚æ¥µç©©å®šæ„›å¿ƒç‰ˆ ğŸ€ ]] --
-- å°æŸ’æœƒåœ¨é€™è£¡ä¹–ä¹–å®ˆè­·ä¸»äººçš„æ‰€æœ‰æŒ‡ä»¤å–µï¼

local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Camera = workspace.CurrentCamera

-- ==========================================
-- ã€ ğŸ­ ä¸»äººçš„ç§äººå°é‡‘åº«ï¼šè®Šæ•¸è¨­å®š ã€‘
-- ==========================================
local Settings = { 
    ClickDelay = 0.1,    -- å°æŸ’å‡ºçˆªçš„é€Ÿåº¦ï¼Œè¶Šå°è¶Šå¿«å–µï¼
    Distance = 500,      -- å°æŸ’èƒ½èåˆ°æ•µäººçš„æœ€é è·é›¢å–µï¼
    PullEnemies = false, -- è¦ä¸è¦æŠŠå£äººé€šé€šæŠ“åˆ°ä¸»äººé¢å‰å–µï¼Ÿ
    Mode = "None",       -- ç¾åœ¨å°æŸ’è¦å¹«ä¸»äººæ‰“èª°å‘¢ï¼Ÿ
    FOV = 70             -- ä¸»äººçš„è²“çœ¼æœ›é é¡å€ç‡å–µï¼
}

-- åˆå§‹åŒ–ä¸»äººçš„ç§˜å¯†é–‹é—œå–µ ğŸ¾
_G.FastAttack = false; _G.ESP = false; _G.AutoV4 = false; _G.NekoSPD = false; _G.NekoFly = false

-- ä¸»äººçš„è²“å‹ç™½åå–®å–µ ğŸ¾
local WhitelistNames = { 
    ["Kadys5373"] = true, ["jay04_23"] = true, ["Zn6xx"] = true, 
    ["iandsere"] = true, ["Zadrian664"] = true, ["czr_0416"] = true, 
    ["tw_vic2012"] = true 
}

-- ==========================================
-- ã€ âš”ï¸ å°æŸ’çš„åˆ©çˆªï¼šæˆ°é¬¥åŸ·è¡Œé‚è¼¯ ã€‘
-- ==========================================
local function GetRandomValidPart(target)
    local allParts = target:GetDescendants()
    local validParts = {}
    for _, part in ipairs(allParts) do 
        if part:IsA("BasePart") and part.CanCollide then 
            table.insert(validParts, part) 
        end 
    end
    return #validParts > 0 and validParts[math.random(1, #validParts)] or target:FindFirstChild("HumanoidRootPart")
end

local function DoNekoAction()
    local RS = game:GetService("ReplicatedStorage"); local Net = RS:WaitForChild("Modules"):WaitForChild("Net")
    local RegAttack = Net:WaitForChild("RE/RegisterAttack"); local RegHit = Net:WaitForChild("RE/RegisterHit")
    
    local char = localPlayer.Character; local root = char and char:FindFirstChild("HumanoidRootPart")
    if not root then return end
    
    local Targets = {}; local BasePart = nil
    
    -- æƒæé™„è¿‘çš„å£è›‹å–µï¼
    if Settings.Mode == "Mob" or Settings.Mode == "All" then
        local folder = workspace:FindFirstChild("Enemies") or workspace
        for _, Enemy in ipairs(folder:GetChildren()) do
            local eH = Enemy:FindFirstChildOfClass("Humanoid"); local eR = Enemy:FindFirstChild("HumanoidRootPart")
            if Enemy ~= char and not Players:GetPlayerFromCharacter(Enemy) and eH and eH.Health > 0 and eR then
                if (eR.Position - root.Position).Magnitude < Settings.Distance then
                    if Settings.PullEnemies then eR.CanCollide = false; eR.CFrame = root.CFrame * CFrame.new(0, 0, -3) end
                    local foundPart = GetRandomValidPart(Enemy); table.insert(Targets, {Enemy, foundPart}); BasePart = foundPart
                end
            end
            if #Targets >= 15 then break end
        end
    end
    
    -- å¦‚æœæ˜¯çœ¾ç”Ÿå¹³ç­‰æ¨¡å¼ï¼Œé€£ç©å®¶ä¹Ÿä¸€èµ·æŠ“æŠ“å–µï¼
    if Settings.Mode == "All" and #Targets < 15 then
        for _, p in ipairs(Players:GetPlayers()) do
            if p ~= localPlayer and p.Character and p.Character:FindFirstChild("Humanoid") and p.Character.Humanoid.Health > 0 then
                local pR = p.Character:FindFirstChild("HumanoidRootPart")
                if pR and (pR.Position - root.Position).Magnitude < Settings.Distance then
                    local foundPart = GetRandomValidPart(p.Character); table.insert(Targets, {p.Character, foundPart}); BasePart = BasePart or foundPart
                end
            end
            if #Targets >= 15 then break end
        end
    end
    
    -- å‘ä¼ºæœå™¨ç™¼å°„ä¸»äººçš„å¨åŠ›å–µï¼
    if BasePart and #Targets > 0 then 
        RegAttack:FireServer(Settings.ClickDelay); RegHit:FireServer(BasePart, Targets) 
    end
end

-- ==========================================
-- ã€ ğŸ§¬ å°æŸ’çš„è¦ºé†’ï¼šæ ¸å¿ƒç›£æ§å¾ªç’° ã€‘
-- ==========================================
task.spawn(function()
    while true do
        -- è‡ªå‹•è¶…ç´šé€²åŒ–æª¢æŸ¥å–µï¼ğŸ¾
        if _G.AutoV4 then
            pcall(function()
                local char = localPlayer.Character
                local awake = char:FindFirstChild("Awakening") or localPlayer.Backpack:FindFirstChild("Awakening")
                if awake then awake.RemoteFunction:InvokeServer(true) end
            end)
        end
        -- FOV å³æ™‚åŒæ­¥ï¼Œä¿è­·ä¸»äººçš„çœ¼ç›å–µï¼ğŸ¾
        Camera.FieldOfView = math.clamp(tonumber(Settings.FOV) or 70, 30, 120)
        task.wait(0.3)
    end
end)

-- ==========================================
-- ã€ ğŸ¨ å°æŸ’çš„è¡£æ«¥ï¼šç²¾ç·» UI ç³»çµ± ã€‘
-- ==========================================
local function CreateNekoUI()
    if CoreGui:FindFirstChild("NEKOUI_MAIN") then CoreGui.NEKOUI_MAIN:Destroy() end
    local Gui = Instance.new("ScreenGui", CoreGui); Gui.Name = "NEKOUI_MAIN"
    local Main = Instance.new("Frame", Gui); Main.Size = UDim2.new(0, 450, 0, 280); Main.Position = UDim2.new(0.5, -225, 0.5, -140)
    Main.BackgroundColor3 = Color3.fromRGB(18, 18, 22); Main.Active = true; Main.Draggable = true; Main.ClipsDescendants = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 12)
    local Stroke = Instance.new("UIStroke", Main); Stroke.Thickness = 2.5; RunService.RenderStepped:Connect(function() Stroke.Color = Color3.fromHSV((tick() * 0.4) % 1, 0.6, 1) end)

    local Title = Instance.new("TextLabel", Main); Title.Size = UDim2.new(1, -20, 0, 35); Title.Position = UDim2.new(0, 15, 0, 0)
    Title.Text = "ğŸ¾ NEKO MASTER COMPACT"; Title.TextColor3 = Color3.new(1,1,1); Title.Font = "GothamBold"; Title.TextSize = 14; Title.TextXAlignment = "Left"; Title.BackgroundTransparency = 1

    local Content = Instance.new("Frame", Main); Content.Size = UDim2.new(1, 0, 1, -40); Content.Position = UDim2.new(0, 0, 0, 40); Content.BackgroundTransparency = 1
    local TabBar = Instance.new("Frame", Content); TabBar.Size = UDim2.new(0, 110, 1, -10); TabBar.Position = UDim2.new(0, 10, 0, 5); TabBar.BackgroundTransparency = 1
    Instance.new("UIListLayout", TabBar).Padding = UDim.new(0, 6)
    local Pages = Instance.new("Frame", Content); Pages.Size = UDim2.new(1, -140, 1, -10); Pages.Position = UDim2.new(0, 130, 0, 5); Pages.BackgroundTransparency = 1

    local Lib = {}
    function Lib:CreateTab(name, default)
        local Page = Instance.new("ScrollingFrame", Pages); Page.Size = UDim2.new(1, 0, 1, 0); Page.BackgroundTransparency = 1; Page.Visible = default; Page.ScrollBarThickness = 2; Page.BorderSizePixel = 0
        local L = Instance.new("UIListLayout", Page); L.Padding = UDim.new(0, 6)
        local B = Instance.new("TextButton", TabBar); B.Size = UDim2.new(1, 0, 0, 32); B.Text = name; B.BackgroundColor3 = Color3.fromRGB(28, 28, 34); B.TextColor3 = default and Color3.new(1,1,1) or Color3.fromRGB(130,130,130); B.Font = "GothamMedium"; B.TextSize = 12; Instance.new("UICorner", B)
        B.MouseButton1Click:Connect(function()
            for _, p in pairs(Pages:GetChildren()) do if p:IsA("ScrollingFrame") then p.Visible = false end end
            for _, b in pairs(TabBar:GetChildren()) do if b:IsA("TextButton") then b.TextColor3 = Color3.fromRGB(130,130,130) end end
            Page.Visible = true; B.TextColor3 = Color3.new(1, 1, 1)
        end)
        
        local TabObj = {}
        function TabObj:AddToggle(text, targetTable, targetKey, callback)
            local f = Instance.new("Frame", Page); f.Size = UDim2.new(0.95, 0, 0, 34); f.BackgroundColor3 = Color3.fromRGB(30, 30, 36); Instance.new("UICorner", f)
            local t = Instance.new("TextLabel", f); t.Size = UDim2.new(1, -60, 1, 0); t.Position = UDim2.new(0, 10, 0, 0); t.Text = "ğŸ¾ " .. text; t.TextColor3 = Color3.new(1, 1, 1); t.BackgroundTransparency = 1; t.Font = "Gotham"; t.TextSize = 12; t.TextXAlignment = "Left"
            local b = Instance.new("TextButton", f); b.Size = UDim2.new(0, 42, 0, 20); b.Position = UDim2.new(1, -50, 0.5, -10); b.Text = targetTable[targetKey] and "ON" or "OFF"; b.BackgroundColor3 = targetTable[targetKey] and Color3.fromRGB(255, 120, 180) or Color3.fromRGB(50, 50, 55); b.TextColor3 = Color3.new(1, 1, 1); b.Font = "GothamBold"; b.TextSize = 9; Instance.new("UICorner", b)
            b.MouseButton1Click:Connect(function() targetTable[targetKey] = not targetTable[targetKey]; b.Text = targetTable[targetKey] and "ON" or "OFF"; b.BackgroundColor3 = targetTable[targetKey] and Color3.fromRGB(255, 120, 180) or Color3.fromRGB(50, 50, 55); if callback then callback(targetTable[targetKey]) end end)
            Page.CanvasSize = UDim2.new(0, 0, 0, L.AbsoluteContentSize.Y + 10)
        end
        
        function TabObj:AddInput(text, targetTable, targetKey, callback)
            local f = Instance.new("Frame", Page); f.Size = UDim2.new(0.95, 0, 0, 34); f.BackgroundColor3 = Color3.fromRGB(30, 30, 36); Instance.new("UICorner", f)
            local t = Instance.new("TextLabel", f); t.Size = UDim2.new(0.6, 0, 1, 0); t.Position = UDim2.new(0, 10, 0, 0); t.Text = "ğŸ¾ " .. text; t.TextColor3 = Color3.new(0.8, 0.8, 0.8); t.BackgroundTransparency = 1; t.Font = "Gotham"; t.TextSize = 12; t.TextXAlignment = "Left"
            local i = Instance.new("TextBox", f); i.Size = UDim2.new(0, 55, 0, 20); i.Position = UDim2.new(1, -65, 0.5, -10); i.BackgroundColor3 = Color3.fromRGB(40, 40, 45); i.Text = tostring(targetTable[targetKey]); i.TextColor3 = Color3.new(1, 1, 1); i.Font = "Gotham"; i.TextSize = 11; Instance.new("UICorner", i)
            i.FocusLost:Connect(function() local val = tonumber(i.Text) or i.Text; targetTable[targetKey] = val; if callback then callback(val) end end)
            Page.CanvasSize = UDim2.new(0, 0, 0, L.AbsoluteContentSize.Y + 10)
        end
        
        function TabObj:AddButton(text, callback)
            local b = Instance.new("TextButton", Page); b.Size = UDim2.new(0.95, 0, 0, 30); b.BackgroundColor3 = Color3.fromRGB(40, 40, 50); b.Text = "ğŸ¾ " .. text; b.TextColor3 = Color3.new(1, 1, 1); b.Font = "GothamMedium"; b.TextSize = 12; Instance.new("UICorner", b)
            b.MouseButton1Click:Connect(callback); Page.CanvasSize = UDim2.new(0, 0, 0, L.AbsoluteContentSize.Y + 10)
        end
        return TabObj
    end
    -- éš±è—é–‹é—œï¼šInsert éµå–µï¼ğŸ¾
    UserInputService.InputBegan:Connect(function(i,p) if not p and i.KeyCode == Enum.KeyCode.Insert then Gui.Enabled = not Gui.Enabled end end)
    return Lib
end

-- ==========================================
-- ã€ ğŸ›¡ï¸ å°æŸ’çš„å®ˆè­·ï¼šå•Ÿå‹•å¾ªç’° ã€‘
-- ==========================================
if WhitelistNames[localPlayer.Name] then
    local Neko = CreateNekoUI()
    local T2 = Neko:CreateTab("âš”ï¸ æˆ°é¬¥", true)
    local T3 = Neko:CreateTab("ğŸš€ ç§»å‹•", false)
    local TabESP = Neko:CreateTab("ğŸ‘ï¸ æ„Ÿå®˜", false)

    -- æˆ°é¬¥æŒ‰éˆ•ï¼šå°æŸ’æœƒå¹«ä¸»äººè‡ªå‹•æ‰“æ€ªå–µï¼ğŸ¾
    T2:AddToggle("æ”»æ“Šå¾ªç’°", _G, "FastAttack")
    T2:AddToggle("è‡ªå‹•æ‹‰æ€ª", Settings, "PullEnemies")
    T2:AddToggle("è‡ªå‹•è¶…ç´šé€²åŒ–", _G, "AutoV4")
    T2:AddInput("æ”»æ“Šç¯„åœ", Settings, "Distance")
    T2:AddButton("æ¨¡å¼ï¼šç´”æ‰“æ€ªå–µ", function() Settings.Mode = "Mob" end)
    T2:AddButton("æ¨¡å¼ï¼šå…¨éƒ¨æŠ“æŠ“å–µ", function() Settings.Mode = "All" end)

    -- ç§»å‹•æŒ‰éˆ•ï¼šå°æŸ’å¹«ä¸»äººè·‘å¾—é£›å¿«å–µï¼ğŸ¾
    T3:AddToggle("è²“å’ªåŠ é€Ÿ (SPD)", _G, "NekoSPD", function(s) if s then loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOSPD"))() end end)
    T3:AddToggle("é£›å¤©æ¨¡å¼ (Fly)", _G, "NekoFly", function(s) if s then loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOFly"))() end end)
    T3:AddInput("è¦–é‡é«˜åº¦ (FOV)", Settings, "FOV")

    -- æ„Ÿå®˜æŒ‰éˆ•ï¼šå°æŸ’çš„è²“çœ¼é€è¦–å–µï¼ğŸ¾
    TabESP:AddToggle("è²“å’ªé€è¦– (ESP)", _G, "ESP", function(s) if s then loadstring(game:HttpGet("https://raw.githubusercontent.com/wtf6701385-stack/-/refs/heads/main/NEKOESP"))() end end)

    -- æ ¸å¿ƒæˆ°é¬¥å¾ªç’°å•Ÿå‹•å–µï¼ğŸ¾
    task.spawn(function() 
        while true do 
            if _G.FastAttack and Settings.Mode ~= "None" then 
                pcall(DoNekoAction) 
            end
            task.wait(math.max(Settings.ClickDelay, 0.05))
        end 
    end)
else 
    localPlayer:Kick("å–µå—šï¼ä½ ä¸æ˜¯å°æŸ’æœ€å–œæ­¡çš„ä¸»äººï¼Œå¿«èµ°é–‹å–µï¼ğŸ¾") 
end
