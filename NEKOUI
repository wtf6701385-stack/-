--[[ ===============================
     NEKO UI - å¯ç”¨ç‰ˆæœ¬
     Button / ButtonWithInput
     Inputï¼šæ•¸å­—é™å®šï¼Œå¤±ç„¦æ‰å¥—ç”¨
================================ ]]

local NekoLib = {}

function NekoLib.Init()
    local RunService = game:GetService("RunService")
    local CoreGui = game:GetService("CoreGui")

    if CoreGui:FindFirstChild("NEKO_UI_FINAL") then
        CoreGui.NEKO_UI_FINAL:Destroy()
    end

    local gui = Instance.new("ScreenGui", CoreGui)
    gui.Name = "NEKO_UI_FINAL"
    gui.ResetOnSpawn = false

    -- ä¸»æ¡†
    local Main = Instance.new("Frame", gui)
    Main.Size = UDim2.new(0, 380, 0, 240)
    Main.Position = UDim2.new(0.5, -190, 0.5, -120)
    Main.BackgroundColor3 = Color3.fromRGB(15,15,17)
    Main.BorderSizePixel = 0
    Main.Active = true
    Main.Draggable = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0,12)

    local Stroke = Instance.new("UIStroke", Main)
    Stroke.Thickness = 2.5

    -- æ¨™é¡Œ
    local Title = Instance.new("TextLabel", Main)
    Title.Size = UDim2.new(1,-20,0,36)
    Title.Position = UDim2.new(0,10,0,6)
    Title.BackgroundTransparency = 1
    Title.Text = "à¸…^â€¢ï»Œâ€¢^à¸…  NEKO UI"
    Title.TextColor3 = Color3.new(1,1,1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 14
    Title.TextXAlignment = Enum.TextXAlignment.Left

    -- å…§å®¹å€
    local Content = Instance.new("ScrollingFrame", Main)
    Content.Size = UDim2.new(1,-20,1,-60)
    Content.Position = UDim2.new(0,10,0,50)
    Content.CanvasSize = UDim2.new()
    Content.ScrollBarThickness = 0
    Content.BackgroundTransparency = 1

    local Layout = Instance.new("UIListLayout", Content)
    Layout.Padding = UDim.new(0,8)

    local function refreshCanvas()
        task.wait()
        Content.CanvasSize = UDim2.new(
            0,0,
            0, Layout.AbsoluteContentSize.Y + 10
        )
    end

    -- å½©è™¹é‚Šæ¡†
    RunService.RenderStepped:Connect(function()
        Stroke.Color = Color3.fromHSV(tick() % 1, 0.6, 1)
    end)

    local Lib = {}

    -- =====================
    -- æ™®é€šæŒ‰éˆ•
    -- =====================
    function Lib:CreateButton(text, callback)
        local btn = Instance.new("TextButton", Content)
        btn.Size = UDim2.new(1,0,0,38)
        btn.BackgroundColor3 = Color3.fromRGB(25,23,28)
        btn.Text = "  ğŸ± "..text
        btn.TextColor3 = Color3.new(1,1,1)
        btn.Font = Enum.Font.GothamMedium
        btn.TextSize = 12
        btn.TextXAlignment = Enum.TextXAlignment.Left
        btn.BorderSizePixel = 0
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)

        btn.MouseButton1Click:Connect(function()
            if callback then callback(btn) end
        end)

        refreshCanvas()
        return btn
    end

    -- ===============================
    -- æŒ‰éˆ• + å³å´è¼¸å…¥æ¡†ï¼ˆæ•¸å­—ï¼‰
    -- å¤±ç„¦æ‰å¥—ç”¨
    -- ===============================
    function Lib:CreateButtonWithInput(text, defaultValue, callback)
        local row = Instance.new("Frame", Content)
        row.Size = UDim2.new(1,0,0,38)
        row.BackgroundTransparency = 1

        -- å·¦æŒ‰éˆ•
        local btn = Instance.new("TextButton", row)
        btn.Size = UDim2.new(0.65,-6,1,0)
        btn.BackgroundColor3 = Color3.fromRGB(25,23,28)
        btn.Text = "  ğŸ± "..text
        btn.TextColor3 = Color3.new(1,1,1)
        btn.Font = Enum.Font.GothamMedium
        btn.TextSize = 12
        btn.TextXAlignment = Enum.TextXAlignment.Left
        btn.BorderSizePixel = 0
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)

        -- å³è¼¸å…¥æ¡†
        local box = Instance.new("TextBox", row)
        box.Size = UDim2.new(0.35,-6,1,0)
        box.Position = UDim2.new(0.65,6,0,0)
        box.BackgroundColor3 = Color3.fromRGB(20,18,23)
        box.Text = tostring(defaultValue or "")
        box.PlaceholderText = "æ•¸å­—"
        box.TextColor3 = Color3.new(1,1,1)
        box.Font = Enum.Font.Gotham
        box.TextSize = 12
        box.ClearTextOnFocus = false
        box.BorderSizePixel = 0
        Instance.new("UICorner", box).CornerRadius = UDim.new(0,8)

        -- é™åˆ¶åªèƒ½è¼¸å…¥æ•¸å­—
        box:GetPropertyChangedSignal("Text"):Connect(function()
            box.Text = box.Text:gsub("%D","")
        end)

        -- å¤±ç„¦æ‰å¥—ç”¨
        box.FocusLost:Connect(function()
            local v = tonumber(box.Text)
            if callback then callback(v) end
        end)

        refreshCanvas()
        return btn, box
    end

    return Lib
end

return NekoLib
